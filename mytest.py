import torch

base_classes = [
    "aeroplane",
    "bicycle",
    "boat",
    "bottle",
    "car",
    "cat",
    "chair",
    "diningtable",
    "dog",
    "horse",
    "person",
    "pottedplant",
    "sheep",
    "train",
    "tvmonitor",
]
novel_classes = ["nectarine", "orange", "cereal", "almond_mix"]
all_classes = [
    "aeroplane",
    "bicycle",
    "boat",
    "bottle",
    "car",
    "cat",
    "chair",
    "diningtable",
    "dog",
    "horse",
    "person",
    "pottedplant",
    "sheep",
    "train",
    "tvmonitor",
    "nectarine",
    "orange",
    "cereal",
    "almond_mix",
]


pred_classes = torch.tensor(
    [
        18,
        17,
        16,
        16,
        15,
        16,
        15,
        15,
        14,
        12,
        11,
        3,
        5,
        7,
        11,
        18,
        15,
        17,
        14,
        16,
        3,
        6,
        12,
        0,
        6,
        14,
        15,
        17,
        17,
        16,
        13,
        10,
        8,
        16,
        15,
        4,
        14,
        5,
        7,
        13,
        17,
        6,
        6,
        0,
        2,
        6,
        0,
        17,
        1,
        1,
        18,
        12,
        10,
        14,
        12,
        2,
        8,
        11,
        8,
        2,
        5,
        8,
        10,
        6,
        9,
        5,
        2,
        9,
        3,
        4,
        10,
        7,
        1,
        4,
        13,
        4,
        10,
        11,
        5,
        0,
        18,
        3,
        0,
        6,
        10,
        4,
        7,
        9,
        12,
        3,
        8,
        18,
        10,
        10,
        1,
        18,
        15,
        2,
        7,
        3,
    ]
)

novel_classes_ordinal = [all_classes.index(c) for c in novel_classes]

hoho = sum(pred_classes == i for i in novel_classes_ordinal)

print(hoho)

exit()


novel_predictions_idx = torch.nonzero(
    sum(pred_classes == i for i in novel_classes_ordinal)
).squeeze()

print(novel_predictions_idx.shape[0])
